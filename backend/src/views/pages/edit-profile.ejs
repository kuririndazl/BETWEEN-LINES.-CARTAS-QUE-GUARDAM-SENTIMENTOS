<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editar Perfil</title>
    <%- include('../partials/head') %>
</head>
<body>
    <%- include('../partials/header') %>
    <main class="main-content">
        <div class="card">
            <h2 style="font-family: 'Arial', 'Helveltica'; color: #a97925; margin-bottom: 25px;">Editar Perfil</h2>

            <% if (message) { %>
                <div class="message-box success-message"><%= message %></div>
            <% } %>

            <% if (error) { %>
                <div class="message-box error-message"><%= error %></div>
            <% } %>

            <!-- IMPORTANTE: enctype="multipart/form-data" para upload de arquivo -->
            <form action="/profile" method="POST" enctype="multipart/form-data">
                
                <div class="form-group" style="text-align: center; margin-bottom: 30px;">
                    <img src="<%= user.profilePictureUrl %>" alt="Foto de Perfil Atual" style="width: 100px; height: 100px; border-radius: 50%; object-fit: cover; border: 3px solid #DBDBDB; margin-bottom: 10px;">
                    <p style="font-weight: 600;">Foto Atual</p>
                </div>

                <div class="form-group">
                    <label for="username">Nome de Usuário</label>
                    <input type="text" id="username" name="username" value="<%= user.username %>" required>
                </div>

                <div class="form-group">
                    <label for="bio">Biografia</label>
                    <textarea id="bio" name="bio" maxlength="255"><%= user.bio %></textarea>
                    <small style="color: #8E8E8E;">Máximo de 255 caracteres.</small>
                </div>

                <div class="form-group">
                    <label for="profile_picture">Alterar Foto de Perfil</label>
                    <input type="file" id="profile_picture" name="profile_picture" accept="image/*">
                    <small style="color: #8E8E8E;">Apenas arquivos de imagem (máx. 2MB). A foto anterior será excluída.</small>
                </div>

                <button type="submit" class="btn-primary" style="width: 100%; margin-top: 15px; background-color:#6d4d16;">Salvar Alterações</button>
            </form>
            
        </div>
    </main>

    <%- include('../partials/footer') %>
</body>
</html>
